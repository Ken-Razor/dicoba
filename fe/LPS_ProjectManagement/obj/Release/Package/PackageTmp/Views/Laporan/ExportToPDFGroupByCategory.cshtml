@model LPS_ProjectManagement.Models.ReportModels.PDFLaporanBulananModel

@{
    Layout = null;
}

@using System.Data;
@{
    //int pointSO = 0;
    int pointProgram = 0;
    string Program = "";
    int pointProject = 0;
    string Project = "";
}

<!DOCTYPE html>


<style>

    .circleBlue {
        border-radius: 50%;
        width: 10px;
        height: 10px;
        background: blue;
    }

    .circleRed {
        border-radius: 50%;
        width: 10px;
        height: 10px;
        background: red;
    }

    .circleGreen {
        border-radius: 50%;
        width: 10px;
        height: 10px;
        background: green;
    }

    .circleYellow {
        border-radius: 50%;
        width: 10px;
        height: 10px;
        background: yellow;
    }
</style>

<style>

    thead {
        display: table-header-group
    }

    tfoot {
        display: table-row-group
    }

    tr {
        page-break-inside: avoid;
    }
</style>

<style>
    thead {
        display: table-header-group
    }

    tfoot {
        display: table-row-group
    }

    tr {
        page-break-inside: avoid;
    }
</style>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>ExportToPDF</title>

    <link href="~/Content/bootstrapmp.min.css" rel="stylesheet" />
    <link href="~/Content/font-awesome.min.css" rel="stylesheet" />
</head>
<body>
    <div>

        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
            <div class="content-body">

                <div class="row">
                    <table style="width:100%;">
                        <tr>
                            <td style="width:25%">
                                <table>
                                    <tr>
                                        <td style="background-color:#86f442; font-size:10px;" class="text-nowrap">
                                            Proyek Non Transformasi (Lampiran 1)
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="background-color:yellow; font-size:10px;" class="text-nowrap">
                                            Proyek Transformasi (Lampiran 2)
                                        </td>
                                    </tr>
                                </table>
                            </td>
                            <td style="width:50%; text-align:center; vertical-align:top;">
                                <b>
                                    @if (Model.HeaderReport.IsTransformasi.ToString() == "Non Transformasi")
                                    {
                                        <b>
                                            LAMPIRAN 1 <br />
                                            EVALUASI CAPAIAN PROYEK NON TRANSFORMASI BULAN @Model.HeaderReport.Bulan.ToString().ToUpper() @Model.HeaderReport.Year.ToString()<br />
                                            (PER KATEGORI)
                                        </b>
                                    }
                                    else if (Model.HeaderReport.IsTransformasi.ToString() == "Transformasi")
                                    {
                                        <b>
                                            LAMPIRAN 2 <br />
                                            EVALUASI CAPAIAN PROYEK TRANSFORMASI BULAN @Model.HeaderReport.Bulan.ToString().ToUpper() @Model.HeaderReport.Year.ToString()<br />
                                            (PER KATEGORI)
                                        </b>
                                    }
                                    else
                                    {
                                        <b>
                                            DAFTAR PROYEK DAN KEGIATAN LEMBAGA TAHUN @Model.HeaderReport.Year.ToString() <br />
                                            (PER KATEGORI)
                                        </b>
                                    }
                                </b>
                            </td>
                            <td style="width:25%">
                                <table>
                                    <tr>
                                        <td>
                                            <div class="circleBlue"></div>
                                        </td>
                                        <td>
                                            &nbsp;
                                        </td>
                                        <td>
                                            <div class="text-nowrap" style="font-size:8px;">Pencapaian diatas target (> 110%)</div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="circleGreen"></div>
                                        </td>
                                        <td>
                                            &nbsp;
                                        </td>
                                        <td>
                                            <div class="text-nowrap" style="font-size:8px;">Pencapaian sesuai target (100% - 109%)</div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="circleYellow"></div>
                                        </td>
                                        <td>
                                            &nbsp;
                                        </td>
                                        <td>
                                            <div class="text-nowrap" style="font-size:8px;">Pencapaian sedikit di bawah target (85% - 99%)</div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="circleRed"></div>
                                        </td>
                                        <td>
                                            &nbsp;
                                        </td>
                                        <td>
                                            <div class="text-nowrap" style="font-size:8px;">Pencapaian jauh di bawah target (< 85%)</div>
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="3">&nbsp;</td>
                        </tr>

                        <tr>
                            <td colspan="3">

                                <table style="width:100%;">
                                    @foreach (var item in Model.ListDataReport)
                                    {
                                        if (item.Tipe.ToString() == "Kategori")
                                        {
                                            pointProject = 0;

                                            <tr>
                                                <td colspan="10"><div class="page-break"></div>&nbsp;</td>
                                            </tr>
                                            <tr>
                                                <td colspan="10" style="text-align:left; color:forestgreen;">&nbsp;</td>
                                            </tr>
                                            <tr>
                                                <td colspan="10" style="text-align:left; color:black;"><label style=" background-color:#da9694;">@item.Name.ToString()</label></td>
                                            </tr>
                                            <tr>
                                                <td colspan="10">&nbsp;</td>
                                            </tr>
                                            <tr style="background-color:#ffc000; border-bottom:1px solid; border-top:1px solid;">
                                                <td rowspan="2" style="text-align:center; font-size:8px; vertical-align:central; width:20%;">Nama Proyek<br />&nbsp;</td>
                                                <td colspan="2" style="text-align:center; font-size:8px; vertical-align:central; width:15%;">Keterangan<br />&nbsp;</td>
                                                <td rowspan="2" style="text-align:center; font-size:8px; vertical-align:central; width:5%;">Nilai (Rp. Juta)<br />&nbsp;</td>
                                                <td rowspan="2" style="text-align:center; font-size:8px; vertical-align:central; width:15%;">Target @Model.HeaderReport.Bulan.ToString() @Model.HeaderReport.Year.ToString()<br />&nbsp;</td>
                                                <td rowspan="2" style="text-align:center; font-size:8px; vertical-align:central; width:15%;">Realisasi @Model.HeaderReport.Bulan.ToString() @Model.HeaderReport.Year.ToString()<br />&nbsp;</td>
                                                <td rowspan="2" style="text-align:center; font-size:8px; vertical-align:central; width:10%;">Capaian @Model.HeaderReport.Bulan.ToString() @Model.HeaderReport.Year.ToString()<br />&nbsp;</td>
                                                <td rowspan="2" style="text-align:center; font-size:8px; vertical-align:central; width:5%;">Realisasi Ang.  @Model.HeaderReport.Bulan.ToString() @Model.HeaderReport.Year.ToString()<br />&nbsp;</td>
                                                <td rowspan="2" style="text-align:center; font-size:8px; vertical-align:central; width:5%;">Real+Komit @Model.HeaderReport.Bulan.ToString() @Model.HeaderReport.Year.ToString()<br />&nbsp;</td>
                                                <td rowspan="2" style="text-align:center; font-size:8px; vertical-align:central; width:10%;">Tren thd bulan lalu<br />&nbsp;</td>
                                            </tr>
                                            <tr style="background-color:#ffc000; border-bottom:1px solid; border-top:1px solid;">
                                                <td style="border-bottom:1px solid; border-top:1px solid; text-align:center; vertical-align:central; font-size:8px; width:5%;">PIC<br />&nbsp;</td>
                                                <td style="border-bottom:1px solid; border-top:1px solid; text-align:center; vertical-align:central; font-size:8px; width:10%;">Waktu<br />&nbsp;</td>
                                            </tr>
                                        }
                                        if (item.Tipe.ToString() == "Project")
                                        {
                                            pointProject = pointProject + 1;
                                            Project = pointProject.ToString() + ". ";
                                            <tr style="border-bottom:1px solid black; border-top:1px solid black;">
                                                @if (item.IsTransformasi.ToString() == "1")
                                                {
                                                    <td style="background-color:yellow; text-align:left; font-size:8px; vertical-align:central;"><br />@Project @item.Name.ToString()</td>
                                                }
                                                else if (item.IsTransformasi.ToString() == "0")
                                                {
                                                    <td style="background-color:#86f442; text-align:left; font-size:8px; vertical-align:central;"><br />@Project @item.Name.ToString()</td>
                                                }
                                                else
                                                {
                                                    <td style="text-align:left; font-size:8px; vertical-align:central;"><br />@Project @item.Name.ToString()</td>
                                                }
                                                <td style="text-align:center; font-size:8px; vertical-align:central;"><br />@item.PIC.ToString()</td>
                                                <td style="text-align:center; font-size:8px; vertical-align:central;"><br />@item.Waktu.ToString()</td>
                                                <td style="text-align:right; font-size:8px; vertical-align:central;"><br />@item.Anggaran.ToString() &nbsp; &nbsp;</td>
                                                <td style="text-align:left; font-size:8px; vertical-align:central;"><br />@item.Target.ToString()</td>
                                                <td style="text-align:left; font-size:8px; vertical-align:central;"><br />@Html.Raw(item.Realisasi.ToString())</td>
                                                <td style="text-align:right; font-size:8px; vertical-align:central;"><br />@Html.Raw(item.RealisasiPencapaian.ToString()) &nbsp; &nbsp;</td>
                                                <td style="text-align:right; font-size:8px; vertical-align:central;"><br />@item.RealisasiAnggaran.ToString() &nbsp; &nbsp;</td>
                                                <td style="text-align:right; font-size:8px; vertical-align:central;"><br />@item.RealisasiKomit.ToString() &nbsp; &nbsp;</td>
                                                @if (item.Tren.ToString() == "Sama")
                                                {
                                                    <td style="text-align:center; font-size:8px; vertical-align:central;"><span class="fa fa-arrow-right" style="color:orange;"></span></td>
                                                }
                                                else if (item.Tren.ToString() == "Naik")
                                                {
                                                    <td style="text-align:center; font-size:8px; vertical-align:central;"><span class="fa fa-arrow-up" style="color:green;"></span></td>
                                                }
                                                else if (item.Tren.ToString() == "Turun")
                                                {
                                                    <td style="text-align:center; font-size:8px; vertical-align:central;"><span class="fa fa-arrow-down" style="color:red;"></span></td>
                                                }
                                                else
                                                {
                                                    <td style="text-align:center; font-size:8px; vertical-align:central;"><span class="fa fa-circle" style="color:grey;"></span></td>
                                                }
                                            </tr>
                                        }
                                        if (item.Tipe.ToString() == "Total")
                                        {
                                            <tr style="background-color:#ffc000; border-bottom:1px solid; border-top:1px solid;">
                                                <td style="text-align:center; font-size:8px; vertical-align:central; width:20%;"><br />Total @item.Name.ToString()&nbsp;</td>
                                                <td style="text-align:center; font-size:8px; vertical-align:central; width:5%;"><br />&nbsp;</td>
                                                <td style="text-align:center; font-size:8px; vertical-align:central; width:10%;"><br />&nbsp;</td>
                                                <td style="text-align:right; font-size:8px; vertical-align:central; width:5%;"><br />@item.Anggaran.ToString() &nbsp; &nbsp;</td>
                                                <td style="text-align:center; font-size:8px; vertical-align:central; width:15%;"><br />&nbsp;</td>
                                                <td style="text-align:center; font-size:8px; vertical-align:central; width:15%;"><br />&nbsp;</td>
                                                <td style="text-align:right; font-size:8px; vertical-align:central; width:10%;"><br />@Html.Raw(item.RealisasiPencapaian.ToString()) &nbsp;</td>
                                                <td style="text-align:right; font-size:8px; vertical-align:central; width:5%;"><br />@item.RealisasiAnggaran.ToString() &nbsp;</td>
                                                <td style="text-align:right; font-size:8px; vertical-align:central; width:5%;"><br />@item.RealisasiKomit.ToString() &nbsp;</td>
                                                <td style="text-align:center; font-size:8px; vertical-align:central; width:10%;"><br />&nbsp;</td>
                                            </tr>
                                        }
                                        if (item.Tipe.ToString() == "Trans")
                                        {
                                            <tr style="background-color:#ffc000; border-bottom:1px solid; border-top:1px solid;">
                                                <td style="text-align:center; font-size:8px; vertical-align:central; width:20%;"><br />Total @item.Name.ToString() (Transformasi)&nbsp;</td>
                                                <td style="text-align:center; font-size:8px; vertical-align:central; width:5%;"><br />&nbsp;</td>
                                                <td style="text-align:center; font-size:8px; vertical-align:central; width:10%;"><br />&nbsp;</td>
                                                <td style="text-align:right; font-size:8px; vertical-align:central; width:5%;"><br />@item.Anggaran.ToString() &nbsp; &nbsp;</td>
                                                <td style="text-align:center; font-size:8px; vertical-align:central; width:15%;"><br />&nbsp;</td>
                                                <td style="text-align:center; font-size:8px; vertical-align:central; width:15%;"><br />&nbsp;</td>
                                                <td style="text-align:right; font-size:8px; vertical-align:central; width:10%;"><br />@Html.Raw(item.RealisasiPencapaian.ToString()) &nbsp;</td>
                                                <td style="text-align:right; font-size:8px; vertical-align:central; width:5%;"><br />@item.RealisasiAnggaran.ToString() &nbsp;</td>
                                                <td style="text-align:right; font-size:8px; vertical-align:central; width:5%;"><br />@item.RealisasiKomit.ToString() &nbsp;</td>
                                                <td style="text-align:center; font-size:8px; vertical-align:central; width:10%;"><br />&nbsp;</td>
                                            </tr>
                                        }
                                        if (item.Tipe.ToString() == "TransNon")
                                        {
                                            <tr style="background-color:#ffc000; border-bottom:1px solid; border-top:1px solid;">
                                                <td style="text-align:center; font-size:8px; vertical-align:central; width:20%;"><br />Total @item.Name.ToString() (Non Transformasi)&nbsp;</td>
                                                <td style="text-align:center; font-size:8px; vertical-align:central; width:5%;"><br />&nbsp;</td>
                                                <td style="text-align:center; font-size:8px; vertical-align:central; width:10%;"><br />&nbsp;</td>
                                                <td style="text-align:right; font-size:8px; vertical-align:central; width:5%;"><br />@item.Anggaran.ToString() &nbsp; &nbsp;</td>
                                                <td style="text-align:center; font-size:8px; vertical-align:central; width:15%;"><br />&nbsp;</td>
                                                <td style="text-align:center; font-size:8px; vertical-align:central; width:15%;"><br />&nbsp;</td>
                                                <td style="text-align:right; font-size:8px; vertical-align:central; width:10%;"><br />@Html.Raw(item.RealisasiPencapaian.ToString()) &nbsp;</td>
                                                <td style="text-align:right; font-size:8px; vertical-align:central; width:5%;"><br />@item.RealisasiAnggaran.ToString() &nbsp;</td>
                                                <td style="text-align:right; font-size:8px; vertical-align:central; width:5%;"><br />@item.RealisasiKomit.ToString() &nbsp;</td>
                                                <td style="text-align:center; font-size:8px; vertical-align:central; width:10%;"><br />&nbsp;</td>
                                            </tr>
                                        }
                                    }

                                </table>
                            </td>
                        </tr>

                    </table>

                </div>

            </div>
        </div>

    </div>

</body>
</html>

<script>

    @*var obj = @Html.Raw(Json.Encode(Model));
    var tipe = '';
    var html = '';

    debugger;

    for (var x = 0; x < obj.ListDataReport.length(); x++) {

        var data = obj.ListDataReport[x];

        if (data.Tipe === 'SO') {

            if (tipe === '') {
                html = html + data.Name;
            } else {
                html = html + '</table>' + data.Name;
            }
            tipe = data.Tipe;
        }
        else if (data.Tipe === 'Program') {

            if (tipe === 'SO') {
                html = html + '<table>' +
                    '<tr>' +
                    '<th>' + '</th>' +
                    '</tr>' +
                    '<tr>' +
                    '<td>' + '</td>' +
                    '</tr>';
            } else {
                html = html + '<table>' +
                    '<tr>' +
                    '<th>' + '</th>' +
                    '</tr>' +
                    '<tr>' +
                    '<td>' + '</td>' +
                    '</tr>';
            }
            tipe = data.Tipe;
        }
        else if (data.Tipe === 'Project') {
            html = html + '<tr>' +
                '<td>' + '</td>' +
                '</tr>';
        }

    }

    html = html + '</table>';

    document.getElementById("dtBody").appendChild(html);*@

</script>