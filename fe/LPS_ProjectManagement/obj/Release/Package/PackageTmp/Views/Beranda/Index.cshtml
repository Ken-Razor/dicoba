@model LPS_ProjectManagement.Models.BerandaInitModel

@{
    ViewBag.Title = "Beranda";
}
@using LPS_ProjectManagement.Helper;

<style>
    .nopadding {
        padding: 0 !important;
        margin: 0 !important;
    }

    .thumb-pic {
        object-fit: cover;
        border-radius: 50%;
        height: 90px;
        width: 90px;
    }

    hr {
        display: block;
        margin-top: 0.5em;
        margin-bottom: 0.5em;
        margin-left: auto;
        margin-right: auto;
        border-style: inset;
        border-width: 1px;
    }

    /* width */
    ::-webkit-scrollbar {
        width: 7px;
    }

    /* Track */
    ::-webkit-scrollbar-track {
        box-shadow: inset 0 0 2px grey;
        border-radius: 20px;
    }

    /* Handle */
    ::-webkit-scrollbar-thumb {
        background: #808080;
        border-radius: 20px;
        opacity: 0.5;
    }

    .task-table {
        width: 100%;
    }

        .task-table tr {
            border-bottom: 1px solid #e2e2e2;
            height: 70px;
        }

            .task-table tr td {
                max-width: 500px;
            }

    .task-status {
        width: 80%;
        height: 2em;
        border-radius: 100px;
        text-align: center;
        margin-right: 100px;
        margin-left: 20px;
        font-weight: bold;
        color: white;
    }

    .task-selesai {
        background-color: #46be8a;
    }

    .task-proses {
        background-color: #bea446;
    }

    /* Main Styles */
    .button {
        display: block;
        background-color: #46be8a;
        width: 200px;
        height: 50px;
        line-height: 50px;
        color: white;
        position: relative;
        top: 0;
        bottom: 0;
        left: 0;
        right: 0;
        cursor: pointer;
        overflow: hidden;
        border-radius: 5px;
        box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.3);
        transition: all 0.25s cubic-bezier(0.31, -0.105, 0.43, 1.4);
    }

        .button span,
        .button .icon {
            display: block;
            height: 100%;
            text-align: center;
            position: absolute;
            top: 0;
        }

        .button span {
            width: 72%;
            line-height: inherit;
            font-size: 22px;
            text-transform: uppercase;
            left: 0;
            transition: all 0.25s cubic-bezier(0.31, -0.105, 0.43, 1.4);
        }

            .button span:after {
                content: '';
                background-color: #27ae60;
                width: 2px;
                height: 70%;
                position: absolute;
                top: 15%;
                right: -1px;
            }

        .button .icon {
            width: 28%;
            right: 0;
            transition: all 0.25s cubic-bezier(0.31, -0.105, 0.43, 1.4);
        }

            .button .icon .fa {
                font-size: 30px;
                vertical-align: middle;
                transition: all 0.25s cubic-bezier(0.31, -0.105, 0.43, 1.4), height 0.25s ease;
            }

            .button .icon .fa-remove {
                height: 36px;
            }

            .button .icon .fa-check {
                display: none;
            }

        .button.success span, .button:hover span {
            left: -72%;
            opacity: 0;
        }

        .button.success .icon, .button:hover .icon {
            width: 100%;
        }

            .button.success .icon .fa, .button:hover .icon .fa {
                font-size: 45px;
            }

        .button.success {
            background-color: #27ae60;
        }

            .button.success .icon .fa-remove {
                display: none;
            }

            .button.success .icon .fa-check {
                display: inline-block;
            }

        .button:hover {
            opacity: .9;
        }

            .button:hover .icon .fa-remove {
                height: 46px;
            }

        .button:active {
            opacity: 1;
        }

</style>

<style>
    /* Center the loader */
    #loaderTrans {
        border: 16px solid #f3f3f3;
        border-radius: 50%;
        border-top: 16px solid blue;
        border-bottom: 16px solid blue;
        width: 120px;
        height: 120px;
        -webkit-animation: spin 2s linear infinite;
        animation: spin 2s linear infinite;
    }

    #loaderPencapaian {
        border: 16px solid #f3f3f3;
        border-radius: 50%;
        border-top: 16px solid blue;
        border-bottom: 16px solid blue;
        width: 120px;
        height: 120px;
        -webkit-animation: spin 2s linear infinite;
        animation: spin 2s linear infinite;
    }

    #loaderHeader {
        border: 16px solid #f3f3f3;
        border-radius: 50%;
        border-top: 16px solid blue;
        border-bottom: 16px solid blue;
        width: 120px;
        height: 120px;
        -webkit-animation: spin 2s linear infinite;
        animation: spin 2s linear infinite;
    }

    #loaderOverAllTrans {
        border: 16px solid #f3f3f3;
        border-radius: 50%;
        border-top: 16px solid blue;
        border-bottom: 16px solid blue;
        width: 120px;
        height: 120px;
        -webkit-animation: spin 2s linear infinite;
        animation: spin 2s linear infinite;
    }

    #loaderOverAll {
        border: 16px solid #f3f3f3;
        border-radius: 50%;
        border-top: 16px solid blue;
        border-bottom: 16px solid blue;
        width: 120px;
        height: 120px;
        -webkit-animation: spin 2s linear infinite;
        animation: spin 2s linear infinite;
    }

    #loaderOverProgressPerProject {
        border: 16px solid #f3f3f3;
        border-radius: 50%;
        border-top: 16px solid blue;
        border-bottom: 16px solid blue;
        width: 120px;
        height: 120px;
        -webkit-animation: spin 2s linear infinite;
        animation: spin 2s linear infinite;
    }
    @@-webkit-keyframes spin {
        0% {
            -webkit-transform: rotate(0deg);
        }

        100% {
            -webkit-transform: rotate(360deg);
        }
    }

    @@keyframes spin {
        0% {
            transform: rotate(0deg);
        }

        100% {
            transform: rotate(360deg);
        }
    }

    /* Add animation to "page content" */
    .animate-bottom {
        position: relative;
        -webkit-animation-name: animatebottom;
        -webkit-animation-duration: 1s;
        animation-name: animatebottom;
        animation-duration: 1s
    }

    @@-webkit-keyframes animatebottom {
        from {
            bottom: -100px;
            opacity: 0
        }

        to {
            bottom: 0px;
            opacity: 1
        }
    }

    @@keyframes animatebottom {
        from {
            bottom: -100px;
            opacity: 0
        }

        to {
            bottom: 0;
            opacity: 1
        }
    }
</style>

<style>
    /*
     CSS for the main interaction
    */
    .tabset > input[type="radio"] {
        position: absolute;
        left: -200vw;
    }

    .tabset .tab-panel {
        display: none;
    }

    .tabset > input:first-child:checked ~ .tab-panels > .tab-panel:first-child,
    .tabset > input:nth-child(3):checked ~ .tab-panels > .tab-panel:nth-child(2),
    .tabset > input:nth-child(5):checked ~ .tab-panels > .tab-panel:nth-child(3),
    .tabset > input:nth-child(7):checked ~ .tab-panels > .tab-panel:nth-child(4),
    .tabset > input:nth-child(9):checked ~ .tab-panels > .tab-panel:nth-child(5),
    .tabset > input:nth-child(11):checked ~ .tab-panels > .tab-panel:nth-child(6),
    .tabset > input:nth-child(13):checked ~ .tab-panels > .tab-panel:nth-child(7) {
        display: block;
    }

    /*
     Styling
    */


    .tabset > label {
        position: relative;
        display: inline-block;
        padding: 15px 15px 25px;
        border: 1px solid transparent;
        border-bottom: 0;
        cursor: pointer;
        font-weight: 600;
        font-family: 'Segoe UI';
        background: #d3d3d3;
    }

        .tabset > label::after {
            content: "";
            position: absolute;
            left: 15px;
            bottom: 10px;
            width: 22px;
            height: 4px;
            background: #8d8d8d;
        }

        .tabset > label:hover,
        .tabset > input:focus + label {
            color: white;
            background-color: #dba628;
        }

            .tabset > label:hover::after,
            .tabset > input:focus + label::after,
            .tabset > input:checked + label::after {
                background: white;
            }

    .tabset > input:checked + label {
        border-color: #ccc;
        border-bottom: 1px solid #fff;
        margin-bottom: -1px;
    }

    .tab-panel {
        padding: 30px 0;
        border-top: 1px solid #ccc;
    }
</style>

<script>

    // -- Table Approval -- \\
    $("#tab-menu").on("click", "li.auto", function (event) {
        if ($(this).hasClass("active") == false) {
            $("#tab-menu>li").removeClass("active");
            $("#tab-menu>li.auto").removeClass("active");
            $("#tab-menu>li>a>span.keyss").removeClass("open");
            $("#tab-menu>li>a>span.keyss").html('keyboard_arrow_right')
            $(this).addClass("active");
            $(this).find("span.keyss").addClass("open");
            $(this).find("span.keyss").html('keyboard_arrow_down')

        } else {
            if ($(event.target).hasClass('childs') == false) {
                $(this).removeClass("active");
                $(this).children().children().removeClass("open");
                $(this).find("span.keyss").html('keyboard_arrow_right')
            }
        }
    });

</script>

<input id="hdfYear" value="@DateTime.Now.Year.ToString()" hidden="hidden" />

<input id="hdfMonth" value="@DateTime.Now.Month.ToString()" hidden="hidden" />


<div class="row">
    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
        <section class="box">
            <div class="content-body padding-top-15" style=" max-height: 450px;overflow: auto;">
                <div class="row padding-5" style="margin:-15px">

                    <div class="col-md-3 padding-top-10">
                        <h2 class="padding-bottom-0" style="margin-bottom:4px">Dashboard Project</h2>
                        <h5 class="padding-top-0">Last Updated : @Model.DashboardProjectHeader.Date</h5>
                        <h5 class="padding-top-0">(@Model.DashboardProjectHeader.Time)</h5>
                        @*<button class="btn btn-success" onclick="UpdatedDashboard()"><i class="fa fa-refresh"></i> Update</button>*@
                    </div>

                    <div class="col-md-2 padding-top-30">
                        <h4>Year</h4>
                        <select id="ddlYear" class="form-control ddlYear" style="width:100%;" onchange="OnOnchangeDdlYear(@DateTime.Now.Year, @DateTime.Now.Month)">
                            @for (int year = Convert.ToInt32(DateTime.Now.Year.ToString()) - 10; year <= Convert.ToInt32(DateTime.Now.Year.ToString()); year++)
                            {
                                if (Convert.ToInt32(DateTime.Now.Year.ToString()) == year)
                                {
                                    <option value=@year selected="selected">@year</option>
                                }
                                else
                                {
                                    <option value=@year>@year</option>
                                }
                            }
                        </select>
                    </div>

                    <div class="col-md-2 padding-top-30">
                        <h4>Month</h4>
                        <select id="ddlMonth" class="form-control ddlMonth" style="width:100%" onchange="OnOnchangeDdlMonth()">
                            @foreach (var item in Model.ListMonth)
                            {
                                if (item.Month == Model.DashboardProjectHeader.Month)
                                {
                                    <option value="@item.Month" selected="selected">@item.Description</option>
                                }
                                else
                                {
                                    <option value="@item.Month">@item.Description</option>
                                }
                            }
                        </select>
                    </div>

                    <div class="col-md-2 padding-top-30" style="vertical-align:central">
                        <h4>Week</h4>
                        <select id="ddlWeek" class="form-control ddlWeek" style="width:100%">

                            @for (int x = 1; x <= Model.DashboardProjectHeader.JumlahWeek; x++)
                            {
                                //if (x == (Model.DashboardProjectHeader.Week - 1))
                                if (x == (Model.DashboardProjectHeader.Week))
                                {
                                    <option value="@x" selected="selected">Minggu Ke-@x</option>
                                }
                                else
                                {
                                    if (x <= Model.DashboardProjectHeader.Week)
                                    {
                                        <option value="@x">Minggu Ke-@x</option>
                                    }
                                }
                            }

                        </select>
                    </div>

                    <div class="col-md-3 padding-top-30" style="text-align:center">
                        <h4>&nbsp;</h4>
                        <button class="btn btn-success" onclick="GenerateDashboard()"><i class="fa fa-search"></i> Generate Dashboard</button>
                    </div>

                </div>
            </div>
        </section>
    </div>
</div>

<div class="row">

    <div id="loaderHeader" style="display:none; vertical-align:central;"></div>

    <div id="divProjectHeaderTotal" class="col-lg-3 col-md-3 col-sm-6 col-xs-6" style="height:auto; display:none">
        <section class="box">
            <header class="panel_header">
                <h2 class="title pull-left" id="lblTotalProject">Total</h2>
            </header>
            <div class="content-body padding-10">
                <div class="row padding-bottom-0 padding-top-5 padding-right-15 padding-left-15">
                    <div class="col-lg-3 col-md-12 col-sm-12 col-xs-12">
                        <img src="~/Assets/Images/Dashboard/Total-Icon.png" style="width:55px" />
                    </div>
                    <div class="col-lg-9 col-md-12 col-sm-12 col-xs-12">
                        <h3 id="lblJumlahProject" class="padding-bottom-0 padding-top-10">0 Project</h3>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <div id="divProjectHeaderPencapaian" class="col-lg-3 col-md-3 col-sm-6 col-xs-6" style="height:auto; display:none">
        <section class="box">
            <header class="panel_header">
                <h2 class="title pull-left">Pencapaian</h2>
            </header>
            <div class="content-body padding-10">
                <div class="row padding-bottom-0 padding-top-5 padding-right-15 padding-left-15">
                    <div class="col-lg-3 col-md-12 col-sm-12 col-xs-12">
                        <img src="~/Assets/Images/Dashboard/Pencapaian-Icon.png" style="width:55px" />
                    </div>
                    <div class="col-lg-9 col-md-12 col-sm-12 col-xs-12">
                        <h3 id="lblPencapaian" class="padding-bottom-0 padding-top-10">0.0 %</h3>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <div id="divProjectHeaderAnggaran" class="col-lg-3 col-md-3 col-sm-6 col-xs-6" style="height:auto; display:none">
        <section class="box">
            <header class="panel_header">
                <h2 class="title pull-left">Anggaran</h2>
            </header>
            <div class="content-body padding-10">
                <div class="row padding-bottom-0 padding-top-5 padding-right-15 padding-left-15">
                    <div class="col-lg-3 col-md-12 col-sm-12 col-xs-12">
                        <img src="~/Assets/Images/Dashboard/Anggaran-icon.png" style="width:55px" />
                    </div>
                    <div class="col-lg-9 col-md-12 col-sm-12 col-xs-12">
                        <h3 id="lblAnggaran" class="padding-bottom-0 padding-top-10">Rp0.00</h3>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <div id="divProjectHeaderRealisasi" class="col-lg-3 col-md-3 col-sm-6 col-xs-6" style="height:auto; display:none">
        <section class="box">
            <header class="panel_header">
                <h2 class="title pull-left">Realisasi</h2>
            </header>
            <div class="content-body padding-10">
                <div class="row padding-bottom-0 padding-top-5 padding-right-15 padding-left-15">
                    <div class="col-lg-3 col-md-12 col-sm-12 col-xs-12">
                        <img src="~/Assets/Images/Dashboard/Realisasi-Icon.png" style="width:55px" />
                    </div>
                    <div class="col-lg-9 col-md-12 col-sm-12 col-xs-12">
                        <h3 id="lblRealisasi" class="padding-bottom-0 padding-top-10">Rp0.00</h3>
                    </div>
                </div>
            </div>
        </section>
    </div>

</div>

<div class="row">

    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
        <section class="box">
            <div class="content-body  padding-top-5 padding-bottom-20 padding-right-0" style="vertical-align:central; padding-bottom:80px">
                <div class="card-body" style="padding-bottom: 0px;">
                    <div class="row card-group-row mb-lg-8pt">
                        <div class="col-lg-4 card-group-row__col">
                            <div class="card card-group-row__card">
                                <div class="card-header d-flex">
                                    <div class="flex row">
                                        <div class="col border-left d-flex flex-column">
                                            <p class="mb-0"><strong>Detail</strong></p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="loaderOverProgressPerProject" style="display:none; vertical-align:central;"></div>
                    <div class="card-body justify-content-center scroll-card" id="bodyPerProject" style="max-height:400px;overflow-y:auto;">
                        @foreach (var item in Model.DashboardProjectProgressPerProject)
                        {
                            <div class="mb-8pt" style="padding-right:10px">
                                <p class="d-flex align-items-center mb-4pt" data-toggle="tooltip" title="@item.NamaProject">
                                    <a href="../../ProyekReport/ProjectExecutionReport?ProjectHeaderID=@item.ID" target="_blank" style="color:black"><small class="flex lh-24pt text-truncate"><strong>@item.NamaProject</strong></small></a>
                                </p>
                                <div class="progress">
                                    @*<div class="progress-bar" style="width: @item.Pencapaian%; background-color:@item.color; color:black" data-toggle="tooltip" title="@item.Pencapaian%" aria-valuemin="0" aria-valuemax="100">C%</div>*@
                                    <div class="progress-bar" role="progressbar" aria-valuenow="@item.Pencapaian"
                                         aria-valuemin="0" aria-valuemax="100" style="width:@item.y%;background-color:@item.color;">
                                        <span style="color:black;font-weight:bold">@item.Pencapaian%</span>
                                    </div>
                                </div>
                            </div>
                        }
                    </div>
                </div>
            </div>
        </section>
    </div>

</div>

<div class="row">

    <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
        <section class="box">
            <div class="content-body  padding-top-5 padding-bottom-20 padding-right-0" style="vertical-align:central; padding-bottom:80px">
                <div id="loaderPencapaian" style="display:none; vertical-align:central;"></div>
                <div id="ProjectProgressStatus"></div>
            </div>
        </section>
    </div>

    <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
        <section class="box">
            <div class="content-body  padding-top-5 padding-bottom-20 padding-right-0" style="vertical-align:central; padding-bottom:80px">
                <div id="loaderTrans" style="display:none; vertical-align:central;"></div>
                <div id="ProjectQuantity"></div>
            </div>
        </section>
    </div>

</div>

<div class="row">

    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
        <section class="box">
            <div class="content-body">

                <div class="row padding-bottom-25" style="text-align:center;">
                    <h3><label>OVERALL PROJECT</label></h3>
                </div>

                <div class="row">
                    <div class="col-lg-1 col-md-1 col-sm-6 col-xs-12">
                        <label style="vertical-align:middle;text-align:center;">Group By</label>
                    </div>
                    <div class="col-lg-2 col-md-2 col-sm-6 col-xs-12">
                        <div class="input-group" inputgroup="">
                            <select id="ddlOverAllProject" class="form-control ddlOverAllProject" onchange="OnchangeDDLOverallProject()">
                                <option value="Unit Kerja">Unit Kerja</option>
                                <option value="Direktorat">Direktorat</option>
                                <option value="Strategic Objective">Strategic Objective</option>
                                <option value="All">All</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-lg-7 col-md-7">&nbsp;</div>
                    <div class="col-lg-2 col-md-2 col-sm-12 col-xs-12">
                        <a class="button" onclick="GetDetails()" role="button">
                            <span>Details</span>
                            <div class="icon">
                                <i class="fa fa-chevron-right"></i>
                                <i class="fa fa-check"></i>
                            </div>
                        </a>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-6">
                        <div id="loaderOverAllTrans" style="display:none; vertical-align:central;"></div>
                        <div id="overallcontainerTrans" style="min-width: 100%; height: 400px; margin: 0 auto"></div>
                    </div>
                    <div class="col-md-6">
                        <div id="loaderOverAll" style="display:none; vertical-align:central;"></div>
                        <div id="overallcontainer" style="min-width: 100%; height: 400px; margin: 0 auto"></div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-12">
                        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-12">
                        <table class="table" id="tableProjectDepartment" style="width:100%"></table>
                    </div>
                </div>

            </div>
        </section>
    </div>

</div>

<div class="row">

    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
        <section class="box">
            <div class="content-body">

                <div class="row padding-bottom-25" style="text-align:center;">
                    <h3><label>TIME SERIES PROJECT</label></h3>
                </div>

                <div class="tab-group">
                    <section id="tab1" title="Transformasi" style="padding-top:2em">
                        <div id="ProjectTimeSeriesTrans"></div>
                    </section>
                    <section id="tab2" title="Non Transformasi">
                        <div id="ProjectTimeSeriesNon"></div>
                    </section>
                </div>
            </div>
        </section>
    </div>

</div>

@*<div class="row">

    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
        <section class="box">
            <div class="content-body">

                <div class="row padding-bottom-25" style="text-align:center;">
                    <h3><label>PROJECT DETAIL</label></h3>
                </div>

                <div class="row">

                </div>
            </div>
        </section>
    </div>

</div>*@

<script src="~/Scripts/jquery.dataTables.min.js"></script>
<script>

    var selectPrjQty;
    var model = '@Html.Raw(Json.Encode(Model))';
    var jsonModel = JSON.parse(model);
    $(document).ready(function () {

        GenerateDashboardInit(jsonModel);

        $('.ddlOverAllProject').select2({
            placeholder: 'Pilih Filter'
        });
        $('.ddlYear').select2({
            placeholder: 'Pilih Tahun'
        });
        $('.ddlMonth').select2({
            placeholder: 'Pilih Bulan'
        });
        $('.ddlWeek').select2({
            placeholder: 'Pilih Minggu'
        });

        // -- Tab -- \\
        $('.tab-group').tabify();
    });

    function OnOnchangeDdlYear(CurrentYear, CurrentMonth) {

        var ListMonth = @Html.Raw(Json.Encode(GlobalHelper.ListDropDowMonth()));

        var Year = $('#ddlYear').val();
        var select = document.getElementById("ddlMonth");

        select.innerHTML = "";

        if (Year == CurrentYear) {
            for (var i = 0; i < 12; i++) {
                if (ListMonth[i].Month == CurrentMonth) {
                    select.innerHTML += "<option value=\"" + ListMonth[i].Month + "\">" + ListMonth[i].Description + "</option>";
                    i = 12;
                }
                else {
                    select.innerHTML += "<option value=\"" + ListMonth[i].Month + "\">" + ListMonth[i].Description + "</option>";
                }
            }
        } else {
            for (var i = 0; i < 12; i++) {
                select.innerHTML += "<option value=\"" + ListMonth[i].Month + "\">" + ListMonth[i].Description + "</option>";
            }
        }

        OnOnchangeDdlMonth();

    }

    function OnOnchangeDdlMonth() {
        var data = {
            Year: $('#ddlYear').val(),
            Month: $('#ddlMonth').val()
        }
        var da = new Date();
        var Cyear = da.getFullYear();
        var Cmonth = da.getMonth() + 1;
        $.ajax({
            type: "GET",
            url: '@Url.Action("GetDdlWeek", "Beranda")',
            data: data,
            traditional: true,
            success: function (result) {
                var select = document.getElementById("ddlWeek");

                // Optional: Clear all existing options first:
                select.innerHTML = "";
                // Populate list with options:
                if (result.Month < Cmonth || result.Year < Cyear) {
                    for (var i = 1; i <= result.JumlahWeek; i++) {
                        var opt = i;
                        select.innerHTML += "<option value=\"" + opt + "\">Minggu Ke-" + opt + "</option>";
                    }
                }
                else {
                    for (var i = 1; i <= result.Week; i++) {
                        var opt = i;
                        select.innerHTML += "<option value=\"" + opt + "\">Minggu Ke-" + opt + "</option>";
                    }
                }
            }
        });
    }

    function UpdatedDashboard() {

        var r = confirm("Melakukan update data akan memberikan dampak penurunan performa pada aplikasi PROMISE, kemungkinan dapat menyebabkan kegagalan transaksi data! Anda yakin ingin melakukan update data?");

        if (r == true) {
            $.ajax({
                type: "GET",
                url: '@Url.Action("GenerateDashboard", "Beranda")',
                traditional: true,
                success: function (result) {
                    if (result.Result === "Success") {
                        alert(result.Message);
                        window.location.href = '@Url.Action("Index", "Beranda")';
                    }
                    else {
                        alert(result.Message);
                    }
                }
            });
        }


    }

    function GenerateDashboardInit(jsonModel) {

        document.getElementById("divProjectHeaderTotal").style.display = "none";
        document.getElementById("divProjectHeaderPencapaian").style.display = "none";
        document.getElementById("divProjectHeaderAnggaran").style.display = "none";
        document.getElementById("divProjectHeaderRealisasi").style.display = "none";

        document.getElementById("ProjectQuantity").style.display = "none";
        document.getElementById("ProjectProgressStatus").style.display = "none";
        document.getElementById("overallcontainerTrans").style.display = "none";
        document.getElementById("overallcontainer").style.display = "none";

        document.getElementById("loaderPencapaian").style.display = "block";
        document.getElementById("loaderTrans").style.display = "block";
        document.getElementById("loaderHeader").style.display = "block";
        document.getElementById("loaderOverAllTrans").style.display = "block";
        document.getElementById("loaderOverAll").style.display = "block";

        GetDashboardProjectHeaderInit('All');
        LoadStatusProgressInit();
        GetDashboardTransAndNoTransInit();
        GetTableOverAllInit();
        GetTimeSeriesInit();
    }

    function GenerateDashboard() {

        document.getElementById("divProjectHeaderTotal").style.display = "none";
        document.getElementById("divProjectHeaderPencapaian").style.display = "none";
        document.getElementById("divProjectHeaderAnggaran").style.display = "none";
        document.getElementById("divProjectHeaderRealisasi").style.display = "none";

        document.getElementById("ProjectQuantity").style.display = "none";
        document.getElementById("ProjectProgressStatus").style.display = "none";
        document.getElementById("overallcontainerTrans").style.display = "none";
        document.getElementById("overallcontainer").style.display = "none";
        document.getElementById("bodyPerProject").style.display = "none";

        document.getElementById("loaderPencapaian").style.display = "block";
        document.getElementById("loaderTrans").style.display = "block";
        document.getElementById("loaderHeader").style.display = "block";
        document.getElementById("loaderOverAllTrans").style.display = "block";
        document.getElementById("loaderOverAll").style.display = "block";
        document.getElementById("loaderOverProgressPerProject").style.display = "block";

        GetDashboardProjectHeader('All');
        LoadStatusProgress('All');
        LoadStatusProgressPerProject('ALL');
        GetDashboardTransAndNoTrans('All');
        GetTableOverAll('Unit Kerja');
        GetTimeSeries();
    }

    function GetDashboardProjectHeader(Filter) {
        var data = {
            Filter: Filter,
            Year: $('#ddlYear').val(),
            Month: $('#ddlMonth').val(),
            Week: $('#ddlWeek').val()
        }
        var label = Filter;
        if (Filter === 'All') label = 'Total';
        $.ajax({
            type: "GET",
            url: '@Url.Action("GetDashboardProjectHeader", "Beranda")',
            data: data,
            traditional: true,
            success: function (result) {
                LoadHeader(label, result.TotalProject, result.Pencapaian, result.Anggaran, result.Realisasi);
            }
        });
    }

    function GetDashboardProjectHeaderInit(Filter) {
        var model = '@Html.Raw(Json.Encode(Model.DashboardProject))';
        var result = JSON.parse(model);
        var label = Filter;
        if (Filter === 'All') label = 'Total';
        LoadHeader(label, result.TotalProject, result.Pencapaian, result.Anggaran, result.Realisasi);
    }

    function LoadStatusProgress(Filter) {
        var dataProgress = {
            Filter: Filter,
            Year: $('#ddlYear').val(),
            Month: $('#ddlMonth').val(),
            Week: $('#ddlWeek').val()
        }
        $.ajax({
            type: "GET",
            url: '@Url.Action("GetDashboardProjectProgress", "Beranda")',
            data: dataProgress,
            traditional: true,
            success: function (result) {
                GetChartProgressStatus(result);
            }
        });
    }

    function LoadStatusProgressInit(result) {
        var model = '@Html.Raw(Json.Encode(Model.DashboardProjectProgress))';
        var result = JSON.parse(model);
        GetChartProgressStatus(result);
    }

    function GetChartProgressStatus(result) {
        document.getElementById("loaderPencapaian").style.display = "none";
        document.getElementById("ProjectProgressStatus").style.display = "block";
        $('#ProjectProgressStatus').highcharts({
            chart: {
                type: 'pie'
            },
            plotOptions: {
                pie: {
                    allowPointSelect: true,
                    cursor: 'pointer',
                    dataLabels: {
                        enabled: true,
                        format: '<b>{point.name}</b>: {point.y} ({point.percentage:.1f} %)',
                        style: {
                            fontSize: '15px',
                            color: (Highcharts.theme && Highcharts.theme.contrastTextColor) || 'black'
                        }
                    },
                    showInLegend: true
                }
            },
            tooltip: {
                pointFormat:
                    'Jumlah: <b>{point.y}</b><br/>' +
                    'Persentase : <b>{point.percentage:.1f} %</b>'
            },
            title: {
                text: 'STATUS'
            },
            legend: {
                itemStyle: {
                    fontSize: '12px',
                }
            },
            exporting: {
                enabled: false
            },
            credits: {
                enabled: false
            },
            series: [{
                colorByPoint: true,
                data: result
            }]
        });
    }

    var htmltxt = "";
    function LoadStatusProgressPerProject(Filter) {
        var dataProgress = {
            Filter: Filter,
            Year: $('#ddlYear').val(),
            Month: $('#ddlMonth').val(),
            Week: $('#ddlWeek').val()
        }
        $.ajax({
            type: "GET",
            url: '@Url.Action("GetDashboardProjectProgressPerProgress", "Beranda")',
            data: dataProgress,
            traditional: true,
            success: function (result) {
                document.getElementById("loaderOverProgressPerProject").style.display = "none";
                document.getElementById("bodyPerProject").style.display = "block";
                if (result != null) {
                    result.forEach(htmlProject);
                    let ele = document.getElementById('bodyPerProject');
                    ele.innerHTML = htmltxt;
                    htmltxt = "";
                }

            }
        });
    }

    function htmlProject(value, index, array) {
        htmltxt += '<div class="mb-8pt" style="padding-right:10px">';
        htmltxt += '<p class="d-flex align-items-center mb-4pt" data-toggle="tooltip" title="'+value.NamaProject+'">';
        htmltxt += ' <a href="../../ProyekReport/ProjectExecutionReport?ProjectHeaderID=' + value.ID +'"  target="_blank" style="color:black"><small class="flex lh-24pt text-truncate"><strong>' + value.NamaProject + '</strong></small></a>';
        htmltxt += '</p>';
        htmltxt += '<div class="progress">';
        htmltxt += '                           <div class="progress-bar" role="progressbar" aria-valuenow="' + value.y + '" aria-valuemin="0" aria-valuemax="100" style="width:' + value.y + '%;background-color:' + value.color + ';">';
        htmltxt += '<span style="color:black;font-weight:bold">'+value.Pencapaian+'%</span>';
        htmltxt += '</div>';
        htmltxt += '</div>';
        htmltxt += '</div>';

    }

    function GetDashboardTransAndNoTrans(Filter) {
        var data = {
            Filter: Filter,
            Year: $('#ddlYear').val(),
            Month: $('#ddlMonth').val(),
            Week: $('#ddlWeek').val()
        }
        $.ajax({
            type: "GET",
            url: '@Url.Action("GetDashboardTransAndNoTrans", "Beranda")',
            data: data,
            traditional: true,
            success: function (result) {
                GetChartTransNonTrans(result);
            }
        });
    }

   function GetDashboardTransAndNoTransInit() {
       var model = '@Html.Raw(Json.Encode(Model.DashboardTransAndNoTrans))';
       var result = JSON.parse(model);
       GetChartTransNonTransInit(result);
    }

    function GetChartTransNonTransInit(result)
    {
        document.getElementById("loaderTrans").style.display = "none";
        document.getElementById("ProjectQuantity").style.display = "block";
        $('#ProjectQuantity').highcharts({
            chart: {
                type: 'pie'
            },
            plotOptions: {
                pie: {
                    allowPointSelect: true,
                    cursor: 'pointer',
                    dataLabels: {
                        enabled: true,
                        format: '{point.y} ({point.percentage:.1f} %)',
                        style: {
                            fontSize: '30px',
                            color: (Highcharts.theme && Highcharts.theme.contrastTextColor) || 'black'
                        }
                    },
                    showInLegend: true,
                    startAngle: 180
                }
            },
            tooltip: {
                pointFormat:
                    'Jumlah: <b>{point.y}</b><br/>' +
                    'Persentase : <b>{point.percentage:.1f} %</b>'
            },
            legend: {
                itemStyle: {
                    fontSize: '20px',
                }
            },
            title: {
                text: 'PROJECT'
            },
            exporting: {
                enabled: false
            },
            credits: {
                enabled: false
            },
            series: [{
                colorByPoint: true,
                data: result,
                point: {
                    events: {
                        unselect: function (event) {
                            if (selectPrjQty === this.id) {
                                document.getElementById("loaderPencapaian").style.display = "block";
                                document.getElementById("loaderHeader").style.display = "block";

                                document.getElementById("ProjectProgressStatus").style.display = "none";
                                document.getElementById("divProjectHeaderTotal").style.display = "none";
                                document.getElementById("divProjectHeaderPencapaian").style.display = "none";
                                document.getElementById("divProjectHeaderAnggaran").style.display = "none";
                                document.getElementById("divProjectHeaderRealisasi").style.display = "none";

                                GetDashboardProjectHeaderInit();
                                LoadStatusProgressInit();
                            }
                        },
                        select: function (event) {
                            if (this.id === 1) {
                                document.getElementById("loaderPencapaian").style.display = "block";
                                document.getElementById("loaderHeader").style.display = "block";

                                document.getElementById("ProjectProgressStatus").style.display = "none";
                                document.getElementById("divProjectHeaderTotal").style.display = "none";
                                document.getElementById("divProjectHeaderPencapaian").style.display = "none";
                                document.getElementById("divProjectHeaderAnggaran").style.display = "none";
                                document.getElementById("divProjectHeaderRealisasi").style.display = "none";

                                selectPrjQty = this.id;

                                GetDashboardProjectHeader('Transformasi');
                                LoadStatusProgress('Transformasi');
                            }
                            else if (this.id === 2) {
                                document.getElementById("loaderPencapaian").style.display = "block";
                                document.getElementById("loaderHeader").style.display = "block";

                                document.getElementById("ProjectProgressStatus").style.display = "none";
                                document.getElementById("divProjectHeaderTotal").style.display = "none";
                                document.getElementById("divProjectHeaderPencapaian").style.display = "none";
                                document.getElementById("divProjectHeaderAnggaran").style.display = "none";
                                document.getElementById("divProjectHeaderRealisasi").style.display = "none";

                                selectPrjQty = this.id;

                                GetDashboardProjectHeader('Non Transformasi');
                                LoadStatusProgress('Non Transformasi');
                            }
                        }
                    }
                }
            }]
        });
    }
    function GetChartTransNonTrans(result) {
        document.getElementById("loaderTrans").style.display = "none";
        document.getElementById("ProjectQuantity").style.display = "block";
        $('#ProjectQuantity').highcharts({
            chart: {
                type: 'pie'
            },
            plotOptions: {
                pie: {
                    allowPointSelect: true,
                    cursor: 'pointer',
                    dataLabels: {
                        enabled: true,
                        format: '{point.y} ({point.percentage:.1f} %)',
                        style: {
                            fontSize: '30px',
                            color: (Highcharts.theme && Highcharts.theme.contrastTextColor) || 'black'
                        }
                    },
                    showInLegend: true,
                    startAngle: 180
                }
            },
            tooltip: {
                pointFormat:
                    'Jumlah: <b>{point.y}</b><br/>' +
                    'Persentase : <b>{point.percentage:.1f} %</b>'
            },
            legend: {
                itemStyle: {
                    fontSize: '20px',
                }
            },
            title: {
                text: 'PROJECT'
            },
            exporting: {
                enabled: false
            },
            credits: {
                enabled: false
            },
            series: [{
                colorByPoint: true,
                data: result,
                point: {
                    events: {
                        unselect: function (event) {
                            if (selectPrjQty === this.id) {
                                document.getElementById("loaderPencapaian").style.display = "block";
                                document.getElementById("loaderHeader").style.display = "block";

                                document.getElementById("ProjectProgressStatus").style.display = "none";
                                document.getElementById("divProjectHeaderTotal").style.display = "none";
                                document.getElementById("divProjectHeaderPencapaian").style.display = "none";
                                document.getElementById("divProjectHeaderAnggaran").style.display = "none";
                                document.getElementById("divProjectHeaderRealisasi").style.display = "none";

                                GetDashboardProjectHeader('All');
                                LoadStatusProgress('All');
                            }
                        },
                        select: function (event) {
                            if (this.id === 1) {
                                document.getElementById("loaderPencapaian").style.display = "block";
                                document.getElementById("loaderHeader").style.display = "block";

                                document.getElementById("ProjectProgressStatus").style.display = "none";
                                document.getElementById("divProjectHeaderTotal").style.display = "none";
                                document.getElementById("divProjectHeaderPencapaian").style.display = "none";
                                document.getElementById("divProjectHeaderAnggaran").style.display = "none";
                                document.getElementById("divProjectHeaderRealisasi").style.display = "none";

                                selectPrjQty = this.id;

                                GetDashboardProjectHeader('Transformasi');
                                LoadStatusProgress('Transformasi');
                            }
                            else if (this.id === 2) {
                                document.getElementById("loaderPencapaian").style.display = "block";
                                document.getElementById("loaderHeader").style.display = "block";

                                document.getElementById("ProjectProgressStatus").style.display = "none";
                                document.getElementById("divProjectHeaderTotal").style.display = "none";
                                document.getElementById("divProjectHeaderPencapaian").style.display = "none";
                                document.getElementById("divProjectHeaderAnggaran").style.display = "none";
                                document.getElementById("divProjectHeaderRealisasi").style.display = "none";

                                selectPrjQty = this.id;

                                GetDashboardProjectHeader('Non Transformasi');
                                LoadStatusProgress('Non Transformasi');
                            }
                        }
                    }
                }
            }]
        });
    }

    function GetTableOverAll(Filter) {

        var data = {
            Filter: Filter,
            Year: $('#ddlYear').val()
        }
        $.ajax({
            type: "GET",
            url: '@Url.Action("GetDashboardProjectOverall", "Beranda")',
            data: data,
            traditional: true,
            success: function (result) {
                if ($.fn.DataTable.isDataTable("#tableProjectDepartment")) {
                    $('#tableProjectDepartment').DataTable().clear();
                    $('#tableProjectDepartment').DataTable().destroy();
                    $('#tableProjectDepartment').empty();
                }

                var Html = '';
                Html += '<thead><tr><th>Type</th>';
                for (var i = 0; i < result.length; i++) {
                    Html += '<th>' + result[i].Code + '</th>';
                }
                Html += '</tr></thead><tbody><tr><td>Transformasi</td>';
                for (var i = 0; i < result.length; i++) {
                    Html += '<td>' + result[i].TotalTransforamsi + '</td>';
                }
                Html += '</tr><tr><td>Non Transformasi</td>';
                for (var i = 0; i < result.length; i++) {
                    Html += '<td>' + result[i].TotalNonTransforamsi + '</td>';
                }
                Html += '</tr></tbody>';

                $("#tableProjectDepartment").append(Html);
                $('#tableProjectDepartment').DataTable({
                    "bLengthChange": false,
                    searching: false,
                    info: false,
                    "pageLength": 4,
                    "scrollX": true
                });
                GetChart(result);
            }
        });

    }

    function GetTableOverAllInit() {
        var model = '@Html.Raw(Json.Encode(Model.DashboardProjectOverall))';
        var result = JSON.parse(model);
        if ($.fn.DataTable.isDataTable("#tableProjectDepartment")) {
            $('#tableProjectDepartment').DataTable().clear();
            $('#tableProjectDepartment').DataTable().destroy();
            $('#tableProjectDepartment').empty();
        }

        var Html = '';
        Html += '<thead><tr><th>Type</th>';
        for (var i = 0; i < result.length; i++) {
            Html += '<th>' + result[i].Code + '</th>';
        }
        Html += '</tr></thead><tbody><tr><td>Transformasi</td>';
        for (var i = 0; i < result.length; i++) {
            Html += '<td>' + result[i].TotalTransforamsi + '</td>';
        }
        Html += '</tr><tr><td>Non Transformasi</td>';
        for (var i = 0; i < result.length; i++) {
            Html += '<td>' + result[i].TotalNonTransforamsi + '</td>';
        }
        Html += '</tr></tbody>';

        $("#tableProjectDepartment").append(Html);
        $('#tableProjectDepartment').DataTable({
            "bLengthChange": false,
            searching: false,
            info: false,
            "pageLength": 4,
            "scrollX": true
        });
        GetChart(result);
    }

    function GetChart(data) {
        var dataTrans = [];
        var dataNoTrans = [];
        for (var x in data) {
            var obj = data[x];
            var dataRows = {
                name: obj.Code,
                data: [obj.TotalTransforamsi]
            }

            var dataRowsNon = {
                name: obj.Code,
                data: [obj.TotalNonTransforamsi]
            }

            dataTrans.push(dataRows);
            dataNoTrans.push(dataRowsNon);
        }

        document.getElementById("loaderOverAllTrans").style.display = "none";
        document.getElementById("loaderOverAll").style.display = "none";
        document.getElementById("overallcontainerTrans").style.display = "block";
        document.getElementById("overallcontainer").style.display = "block";
        Highcharts.chart('overallcontainer', {
            chart: {
                type: 'column'
            },
            title: {
                text: 'Non Transformasi'
            },
            exporting: {
                enabled: false
            },
            credits: {
                enabled: false
            },
            xAxis: {
                categories: [''],
            },
            yAxis: {
                allowDecimals: false,
                title: {
                    text: 'Project'
                }
            },
            //tooltip: {
            //    formatter: function () {
            //        return '<b>' + this.series.name + '</b><br/>' +
            //            this.point.y + ' ' + this.point.name.toLowerCase();
            //    }
            //},
            series: dataNoTrans
        });

        Highcharts.chart('overallcontainerTrans', {
            chart: {
                type: 'column'
            },
            title: {
                text: 'Transformasi'
            },
            exporting: {
                enabled: false
            },
            credits: {
                enabled: false
            },
            xAxis: {
                categories: [''],
            },
            yAxis: {
                allowDecimals: false,
                title: {
                    text: 'Project'
                }
            },
            series: dataTrans
        });
    }

    function GetTimeSeriesInit(resultTrans, resultNonTrans) {
        var model = '@Html.Raw(Json.Encode(Model.DashboardProjectTimeSeriesTransformasi))';
        var resultTrans = JSON.parse(model);
        model = '@Html.Raw(Json.Encode(Model.DashboardProjectTimeSeriesNonTransformasi))';
        var resultNonTrans = JSON.parse(model);
        GetTimeSeriesChart('Transformasi', resultTrans);
        GetTimeSeriesChart('Non Transformasi', resultNonTrans);
    }

    function GetTimeSeries() {
        var data = {
            Filter: 'Transformasi',
            Year: $('#ddlYear').val(),
            Month: $('#ddlMonth').val(),
            Week: $('#ddlWeek').val()
        }

        $.ajax({
            type: "GET",
            url: '@Url.Action("GetDashboardProjectTimeSeries", "Beranda")',
            data: data,
            traditional: true,
            success: function (result) {
                GetTimeSeriesChart('Transformasi', result);
            }
        });

        var data = {
            Filter: 'Non Transformasi',
            Year: $('#ddlYear').val(),
            Month: $('#ddlMonth').val(),
            Week: $('#ddlWeek').val()
        }

        $.ajax({
            type: "GET",
            url: '@Url.Action("GetDashboardProjectTimeSeries", "Beranda")',
            data: data,
            traditional: true,
            success: function (result) {
                GetTimeSeriesChart('Non Transformasi', result);
            }
        });
    }

    function GetTimeSeriesChart(tittle, data) {

        var Realisasi = [];
        var Target = [];
        var Periode = [];

        Periode.push('-');

        for (var x in data) {
            var obj = data[x];
            Periode.push(obj.Periode);
            Realisasi.push(obj.Realisasi);
            Target.push(obj.Target);
        }

        if (tittle == 'Transformasi') {

            Highcharts.chart('ProjectTimeSeriesTrans', {

                title: {
                    text: ''
                },
                exporting: {
                    enabled: false
                },
                credits: {
                    enabled: false
                },
                yAxis: {
                    title: {
                        text: 'Percentage'
                    }
                },
                xAxis: {
                    categories: Periode
                },
                legend: {
                    layout: 'vertical',
                    align: 'right',
                    verticalAlign: 'middle'
                },
                plotOptions: {
                    series: {
                        label: {
                            connectorAllowed: false
                        },
                        pointStart: 1,
                        cursor: 'pointer',
                    }
                },
                series: [{
                    name: 'Realisasi',
                    data: Realisasi
                }, {
                    name: 'Target',
                    data: Target
                }],
                responsive: {
                    rules: [{
                        condition: {
                            maxWidth: 500
                        },
                        chartOptions: {
                            legend: {
                                layout: 'horizontal',
                                align: 'center',
                                verticalAlign: 'bottom'
                            }
                        }
                    }]
                }

            });

        }
        else {

            Highcharts.chart('ProjectTimeSeriesNon', {

                title: {
                    text: ''
                },
                exporting: {
                    enabled: false
                },
                credits: {
                    enabled: false
                },
                yAxis: {
                    title: {
                        text: 'Percentage'
                    }
                },
                xAxis: {
                    categories: Periode
                },
                legend: {
                    layout: 'vertical',
                    align: 'right',
                    verticalAlign: 'middle'
                },
                plotOptions: {
                    series: {
                        label: {
                            connectorAllowed: false
                        },
                        pointStart: 1,
                        cursor: 'pointer',
                    }
                },
                series: [{
                    name: 'Realisasi',
                    data: Realisasi
                }, {
                    name: 'Target',
                    data: Target
                }],
                responsive: {
                    rules: [{
                        condition: {
                            maxWidth: 500
                        },
                        chartOptions: {
                            legend: {
                                layout: 'horizontal',
                                align: 'center',
                                verticalAlign: 'bottom'
                            }
                        }
                    }]
                }

            });

        }
    }

    function LoadHeader(Title, TotalProject, Pencapaian, Anggaran, Realisasi) {
        document.getElementById("loaderHeader").style.display = "none";
        document.getElementById("divProjectHeaderTotal").style.display = "block";
        document.getElementById("divProjectHeaderPencapaian").style.display = "block";
        document.getElementById("divProjectHeaderAnggaran").style.display = "block";
        document.getElementById("divProjectHeaderRealisasi").style.display = "block";

        document.getElementById("lblTotalProject").innerHTML = Title;
        document.getElementById("lblJumlahProject").innerHTML = TotalProject + " Project";
        document.getElementById("lblPencapaian").innerHTML = Pencapaian + " %";
        document.getElementById("lblAnggaran").innerHTML = Anggaran;
        document.getElementById("lblRealisasi").innerHTML = Realisasi;
    }

    function OnchangeDDLOverallProject() {
        document.getElementById("loaderOverAllTrans").style.display = "block";
        document.getElementById("loaderOverAll").style.display = "block";

        document.getElementById("overallcontainerTrans").style.display = "none";
        document.getElementById("overallcontainer").style.display = "none";

        var Filter = $('#ddlOverAllProject').val();
        GetTableOverAll(Filter);
    };

    function GetDetails() {
        var urlBerandaSO = '@Url.Action("Index", "BerandaSO")?Filter=' +
            $('#ddlOverAllProject').val() +
            '&Year=' + $('#ddlYear').val() +
            '&Month=' + $('#ddlMonth').val() +
            '&week=' + $('#ddlWeek').val() +
            '&JumlahWeek=' + $('#ddlWeek option:last').val();
        location.href = urlBerandaSO;
    }

</script>
