@model List<LPS_ProjectManagement.Models.MasterDataModels.KPIValueModel>
@using LPS_ProjectManagement.Models

@{
    ViewBag.Title = "KPI Value";
    Layout = "~/Views/Shared/_Layout.cshtml";
    RoleProject[] RoleAplikasi = (RoleProject[])Session["Roles"];
}

<style type="text/css">
    /*
        loaders
        */
    .spin {
        -webkit-animation: spin 750ms infinite linear;
        -moz-animation: spin 750ms infinite linear;
        animation: spin 750ms infinite linear;
    }

    @@-webkit-keyframes spin {
        to {
            -webkit-transform: rotate(360deg);
        }
    }

    @@-moz-keyframes spin {
        to {
            -moz-transform: rotate(360deg);
        }
    }

    .rspin {
        -webkit-animation: rspin 2250ms infinite linear;
        -moz-animation: rspin 2250ms infinite linear;
        animation: rspin 2250ms infinite linear;
    }

    @@-webkit-keyframes rspin {
        to {
            -webkit-transform: rotate(-360deg);
        }
    }

    @@-moz-keyframes rspin {
        to {
            -moz-transform: rotate(-360deg);
        }
    }
    /* let's style that thing */
    .loader {
        background-color: #eeeeee;
        border-radius: 100%;
        position: relative;
        height: 75px;
        width: 75px;
        overflow: hidden;
    }

        .loader .c {
            position: absolute;
            left: 50%;
            top: 50%;
            margin: -34% 0 0 -34%;
            width: 68%;
            height: 68%;
            background-color: #ffffff;
            border-radius: 100%;
            z-index: 3;
        }

        .loader .d {
            position: absolute;
            top: 0;
            bottom: 0;
            left: 0;
            right: 0;
        }

            .loader .d .e {
                position: absolute;
                top: 1%;
                left: 50%;
                margin: 0 0 0 -7.5px;
                height: 14px;
                width: 15px;
                -webkit-transform: rotate(10deg) skew(20deg);
                -moz-transform: rotate(10deg) skew(20deg);
                border-radius: 3px;
                background: #999;
            }

        .loader .r {
            z-index: 2;
            position: absolute;
            left: 50%;
            top: -1px;
            bottom: -1px;
            margin-left: -3.75px;
            background-color: #ffffff;
            width: 7.5px;
        }

        .loader .r1 {
            -webkit-transform: rotate(0deg);
            -moz-transform: rotate(0deg);
        }

        .loader .r2 {
            -webkit-transform: rotate(45deg);
            -moz-transform: rotate(45deg);
        }

        .loader .r3 {
            -webkit-transform: rotate(90deg);
            -moz-transform: rotate(90deg);
        }

        .loader .r4 {
            -webkit-transform: rotate(135deg);
            -moz-transform: rotate(135deg);
        }

    /***/

</style>

<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
    <section class="box">
        <header class="panel_header">
            <h2 class="title pull-left">Daftar Project</h2>
        </header>
        <div class="content-body padding-top-45">

            <div class="row">
                <div class="col-md-12 col-sm-12 col-xs-12 padding-left-0 padding-right-0">
                    <div class="row">
                        &nbsp;
                    </div>

                    <table id="tblListProject" class="display" style="width:100%">
                        <thead>
                            <tr>
                                <th style="text-align:center" width="3%">No.</th>
                                <th style="text-align:left" width="20%">Kode Project</th>
                                <th style="text-align:left" width="20%">Nama Project</th>
                                <th style="text-align:right">TW 1(%)</th>
                                <th style="text-align:right">TW 2(%)</th>
                                <th style="text-align:right">TW 3(%)</th>
                                <th style="text-align:right">TW 4(%)</th>
                                <th style="text-align:center">Aksi</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var data in Model)
                            {
                                <tr>
                                    <td style="text-align:center">@data.NoUrut</td>
                                    <td style="text-align:left">@data.ProjectNo</td>
                                    <td style="text-align:left">@data.ProjectName</td>
                                    <td style="text-align:right">@data.TW1</td>
                                    <td style="text-align:right">@data.TW2</td>
                                    <td style="text-align:right">@data.TW3</td>
                                    <td style="text-align:right">@data.TW4</td>
                                    <td style="text-align:center">
                                        <a href='@Url.Action("DetailKPIValue","Master", new {IDProject= data.IDProject})' class="btn btn-warning tooltipcustom margin-top-5 margin-bottom-5">
                                            <i class="fa fa-edit"></i>
                                            <span class="tooltiptext">Detil</span>
                                        </a>
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </section>

    <section class="box">
        <header class="panel_header">
            <h2 class="title pull-left">Generate KPI</h2>
        </header>
        <div class="content-body padding-top-45">
            <div class="loader rspin ll" style="margin-left : 50px;">
                <span class="c"></span>
                <span class="d spin"><span class="e"></span></span>
                <span class="r r1"></span>
                <span class="r r2"></span>
                <span class="r r3"></span>
                <span class="r r4"></span>
            </div>
            <button id="generateBtn" class="btn btn-default tooltipcustom" type="button" onclick="GenerateKPIValue()">
                <i class="fa fa-edit"></i>
                <span class="tooltiptext">Generate KPI Value</span>
            </button>
        </div>
    </section>

</div>


<script>
    $(document).ready(function () {
        $('#tblListProject').DataTable({
            "bLengthChange": false,
            searching: true,
            info: false,
            "scrollX": true
        });

    });
</script>

<script>
    $(".ll").hide();

    //$(document).on('click', ".btn", function (e) {
    //    e.preventDefault();
    //    id = $(this).attr('id')
    //    if (id == 'generateBtn') {
    //        document.getElementById("generateBtn").disabled = true;
    //        $('#generateBtn').addClass('spinner');
    //    }
    //});

    function GenerateKPIValue() {
        $.ajax({
            type: "GET",
            url: '@Url.Action("GenerateKPIValue", "Master")',
            beforeSend: function () {
                $(".ll").show();
            },
            complete: function () {
                $(".ll").hide();
            },
            success: function (result) {
                if (result.Result === "Success") {
                    debugger;
                    alert(result.Message);
                    location.reload();
                }
                else {
                    debugger;
                    alert(result.Message);
                }
            }
        });
    }
</script>
