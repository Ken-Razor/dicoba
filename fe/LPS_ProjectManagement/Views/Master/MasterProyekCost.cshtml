@using LPS_ProjectManagement.Models
@model List<LPS_ProjectManagement.Models.MasterDataModels.ProjectCostModel>

@{
    if (Model.Capacity > 0)
    {
        List<LPS_ProjectManagement.Models.MasterDataModels.ProjectCostModel> dt = Model;
    }

    //ViewBag.Title = "Master Data Kegiatan";
    //Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
    <section class="box">
        <header class="panel_header">
            <h2 class="title pull-left">Daftar Kegiatan</h2>
        </header>
        <div class="content-body padding-top-45">
            <div class="row">
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                    <input type="text" class="form-control-label" value="Last Updated : @Model[0].UpdatedBy" disabled="disabled" style="width:20%" />
                </div>
            </div>
            <div class="row">
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                    <table id="tblListProjectCost" class="display" style="width:100%">
                        <thead>
                            <tr>
                                <th style="text-align:center" width="3%">No.</th>
                                <th style="text-align:left" width="10%">Kode Kegiatan</th>
                                <th style="text-align:left">Nama Kegiatan</th>
                                <th style="text-align:center">Tahun</th>
                                <th style="text-align:right">Anggaran</th>
                                <th style="text-align:right">Pergeseran</th>
                                <th style="text-align:right">Hangus</th>
                                <th style="text-align:right">Realisasi</th>
                                <th style="text-align:right">Komitmen</th>
                            </tr>
                        </thead>
                        <tbody>
                            @if (Model != null)
                            {
                                if (Model.Count > 0)
                                {
                                    foreach (var item in Model)
                                    {
                                        <tr>
                                            <td>
                                                @Html.DisplayFor(modelItem => item.NoUrut)
                                            </td>
                                            <td>
                                                @Html.DisplayFor(modelItem => item.ProjectCostCode)
                                            </td>
                                            <td>
                                                @Html.DisplayFor(modelItem => item.ProjectCostName)
                                            </td>
                                            <td class="dt-body-center">
                                                @Html.DisplayFor(modelItem => item.Year)
                                            </td>
                                            <td class="dt-body-right">
                                                @Html.DisplayFor(modelItem => item.Value)
                                            </td>
                                            <td class="dt-body-right">
                                                @Html.DisplayFor(modelItem => item.Pergeseran)
                                            </td>
                                            <td class="dt-body-right">
                                                @Html.DisplayFor(modelItem => item.Hangus)
                                            </td>
                                            <td class="dt-body-right">
                                                @Html.DisplayFor(modelItem => item.Realisasi)
                                            </td>
                                            <td class="dt-body-right">
                                                @Html.DisplayFor(modelItem => item.Komitmen)
                                            </td>
                                        </tr>
                                    }
                                }
                            }

                        </tbody>
                    </table>
                </div>
            </div>

        </div>
    </section>
</div>

<script>

    $(document).ready(function () {
        //$('#tblListUser').DataTable({
        //    "bLengthChange": false,
        //    searching: true,
        //    info: false
        //});
        $('#tblListProjectCost').DataTable({
            "bLengthChange": false,
            searching: true,
            info: false,
            "paging": true
        });

        @*$.ajax({
            type: "GET",
            url: '@Url.Action("MasterProyekCostJson","Master")',
            dataType: "json",
            contentType: "application/json; charset=utf-8",
            success: function (result) {
                debugger;
                $('#tblListProjectCost').DataTable({
                    "processing": true,
                    "bLengthChange": false,
                    searching: true,
                    info: false,
                    data: result.data,
                    "columns": [
                        { "data": "NoUrut" },
                        { "data": "ProjectCostCode" },
                        { "data": "ProjectCostName" },
                        { "data": "Year", className: 'dt-body-center' },
                        { "data": "Value", className: 'dt-body-right' },
                        { "data": "Pergeseran", className: 'dt-body-right' },
                        { "data": "Hangus", className: 'dt-body-right' },
                        { "data": "Realisasi", className: 'dt-body-right' },
                        { "data": "Komitmen", className: 'dt-body-right' }
                    ]
                });
            },
            error: function (xhr, ajaxOptions, thrownError) {
                debugger;
                    alert(xhr.status);
                    alert(thrownError);
            }
        });*@

    });

    function deleteData(id) {
        var ProjectCost = {
            IDProjectCost: id
        };

        var r = confirm("Anda yakin ingin menghapus Cost ini ?");
        if (r == true) {
            $.ajax({
                type: "POST",
                url: '@Url.Action("DeleteProyekCost", "Master")',
                data: ProjectCost,
                success: function (result) {
                    if (result.Result === "Success") {
                        alert(result.Message);
                        window.location.href = '@Url.Action("MasterProyekCost", "Master")';
                    } else {
                        alert(result.Message);
                    }
                },
                error: function (xhr, ajaxOptions, thrownError) {
                    alert(xhr.status);
                    alert(thrownError);
                }
            });
        };
    }

</script>
